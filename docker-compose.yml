version: '3.8'

services:
  openclaw:
    build: .
    container_name: openclaw-gateway
    restart: always
    ports:
      - "18789:18789"
    environment:
      # --- CORE SETTINGS ---
      - PORT=18789
      - GATEWAY_MODE=local
      - OPENCLAW_HOME=/home/openclaw/.openclaw
      
      # --- AI PROVIDER (Enter these in Coolify UI) ---
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      
      # --- WEBHOOK SECURITY ---
      - OPENCLAW_HOOKS_ENABLED=true
      - OPENCLAW_HOOKS_TOKEN=${WEBHOOK_TOKEN:-nexus-secure-token-2026}

    volumes:
      # Persistent storage for memory and config
      - openclaw_data:/home/openclaw/.openclaw
      # The workspace where the bot writes code and stores task files
      - openclaw_workspace:/home/openclaw/workspace

    # Resource Limits for your 8GB RAM VPS
    deploy:
      resources:
        limits:
          memory: 2G
        reservations:
          memory: 512M

volumes:
  openclaw_data:
  openclaw_workspace:

networks:
  default:
    name: coolify
